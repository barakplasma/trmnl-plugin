{% assign kids = "" | split: "," %}
{% for i in (1..4) %}
  {% capture name_key %}kid_{{ i }}_name{% endcapture %}
  {% capture birthday_key %}kid_{{ i }}_birthday{% endcapture %}
  {% assign name = config[name_key] | default: "" | strip %}
  {% assign birthday_str = config[birthday_key] | default: "" | strip %}

  {% if name != "" and birthday_str != "" %}
    {% assign bday_ts = birthday_str | date: "%s" %}
    {% assign now_ts = "now" | date: "%s" %}
    {% assign age_seconds = now_ts | minus: bday_ts %}
    {% assign age_days = age_seconds | divided_by: 86400 %}

    {% assign years = age_days | divided_by: 365.25 | floor %}
    {% assign remaining_days = age_days | minus: years | times: 365.25 | floor %}
    {% assign months = remaining_days | divided_by: 30.4375 | floor %}
    {% assign days = remaining_days | minus: months | times: 30.4375 | floor %}

    {% assign bday_formatted = birthday_str | date: "%s" | date: "%A %B %-d, %Y" %}
    {% assign now_formatted = "now" | date: "%A %B %-d, %Y" %}

    {% assign kid = "" %}
    {% capture kid %}{{ name }},{{ birthday_str }},{{ bday_formatted }},{{ now_formatted }},{{ years }},{{ months }},{{ days }}{% endcapture %}
    {% assign kids = kids | push: kid %}
  {% endif %}
{% endfor %}
